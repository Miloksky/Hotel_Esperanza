<div class="register-container">

  <div *ngIf="successMessage" class="alert-success" role="alert">
      {{ successMessage }}
    </div>

  <h2>Registro de Usuario</h2>
  <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label for="name">Nombre Completo:</label>
      <input type="text" id="name" formControlName="name" class="form-control"
             [ngClass]="{ 'is-invalid': f['name'].touched && f['name'].errors }">
      <div *ngIf="f['name'].touched && f['name'].errors" class="invalid-feedback">
        <div *ngIf="f['name'].errors['required']">El nombre es requerido.</div>
      </div>
    </div>

    <div class="form-group">
      <label for="email">Correo Electrónico:</label>
      <input type="email" id="email" formControlName="email" class="form-control"
             [ngClass]="{ 'is-invalid': f['email'].touched && f['email'].errors }">
      <div *ngIf="f['email'].touched && f['email'].errors" class="invalid-feedback">
        <div *ngIf="f['email'].errors['required']">El correo electrónico es requerido.</div>
        <div *ngIf="f['email'].errors['email']">Por favor, introduce un correo electrónico válido.</div>
      </div>
    </div>

    <div class="form-group">
      <label for="password">Contraseña:</label>
      <div class="input-group"> <!-- Un contenedor para el input y el botón -->
        <input [type]="showPassword ? 'text' : 'password'"
               id="password"
               formControlName="password"
               class="form-control"
               [ngClass]="{ 'is-invalid': f['password'].touched && f['password'].errors }">
        <button type="button" class="btn btn-outline-secondary" (click)="togglePasswordVisibility()">
          {{ showPassword ? 'Ocultar' : 'Mostrar' }}
          <i class="fas" [ngClass]="showPassword ? 'fa-eye-slash' : 'fa-eye'"></i>
        </button>
      </div>
      <div *ngIf="f['password'].touched && f['password'].errors" class="invalid-feedback">
        <div *ngIf="f['password'].errors['required']">La contraseña es requerida.</div>
        <div *ngIf="f['password'].errors['minlength']">La contraseña debe tener al menos 6 carácteres.</div>
        <div *ngIf="f['password'].errors['passwordStrength']">
          La contraseña debe contener al menos una letra mayúscula y un símbolo (por ejemplo: !, -, #, etc).
        </div>
      </div>
    </div>

    <div class="form-group">
      <label for="phone">Teléfono <span>(opcional):</span></label>
      <input type="text" id="phone" formControlName="phone" class="form-control"
             [ngClass]="{ 'is-invalid': f['phone'].touched && f['phone'].errors }">
      <div *ngIf="f['phone'].touched && f['phone'].errors" class="invalid-feedback">
        <div *ngIf="f['phone'].errors['pattern']">El teléfono solo debe contener dígitos.</div>
        <div *ngIf="f['phone'].errors['minlength'] || f['phone'].errors['maxlength']">
          El teléfono debe tener 9 dígitos.
        </div>
        <div *ngIf="f['phone'].errors['invalidPhone']">
          El formato del teléfono no es válido.
        </div>
      </div>
    </div>

  <div class="form-group">
  <label for="document">NIF/NIE <span>(opcional):</span></label>
  <input type="text" id="document" formControlName="document" class="form-control"
         [ngClass]="{ 'is-invalid': f['document'].touched && f['document'].errors }">
  <div *ngIf="f['document'].touched && f['document'].errors" class="invalid-feedback">
    <div *ngIf="f['document'].errors['invalidNifNie']">
      El formato del NIF o NIE no es válido. Ej: 12345678Z o X1234567L
    </div>
  </div>
</div>


    <button type="submit" [disabled]="registerForm.invalid" class="btn btn-primary">Registrarse</button>

    <div *ngIf="formError" class="alert-danger" role="alert">
      {{ formError }}
    </div>

    

  </form>
</div>